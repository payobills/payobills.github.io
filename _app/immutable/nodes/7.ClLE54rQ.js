const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CHyJ2wzr.js","../chunks/CcW_GNUA.js","../chunks/B1x8ai2h.js","../chunks/DIeogL5L.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import"../chunks/69_IOA4Y.js";import{s as $,o as we}from"../chunks/CudHTZsQ.js";import{g as me,z as u,C as i,x as m,q as n,G as l,B as o,k as c,l as _e,j as de,O as U,J as z,K as F,H as L,v as e,I as De,F as ye,D as ve,A as Se,i as Ae}from"../chunks/B1x8ai2h.js";import{p as D,i as N,s as Ce,a as pe,b as fe}from"../chunks/-QHvesP2.js";import{i as ge}from"../chunks/DXIOgzev.js";import{i as k,s as oe,j as Be,k as Ne,l as be,e as Fe,m as xe}from"../chunks/6PD_s1A2.js";import{g as Te}from"../chunks/BRDOIGdq.js";import{f as Ie,a as Re,B as Qe}from"../chunks/BD6bfkde.js";import{_ as Ee}from"../chunks/CjVXStdI.js";import{n as Ye}from"../chunks/Cct0ilKN.js";import{l as Me,C as Pe}from"../chunks/CcW_GNUA.js";var Ue=u('<span class="pill--filled svelte-rf6rz1"></span> <span class="pill--empty svelte-rf6rz1"></span> <span class="pill--filled svelte-rf6rz1"></span>',1),Le=u('<span class="pill--empty svelte-rf6rz1"></span> <span class="pill--filled svelte-rf6rz1"></span> <span class="pill--empty svelte-rf6rz1"></span>',1),Oe=u('<span class="item-title svelte-rf6rz1"> </span>'),ke=u('<div class="item"><div class="pill svelte-rf6rz1"><!></div> <!></div>');function $e(q,v){me(v,!1);let t=D(v,"item",8),d=D(v,"showLabel",8,!0);ge();var b=ke(),_=i(b),A=i(_);{var S=g=>{var f=Ue(),h=de(f);k(h,"data-start",0);var x=o(h,2),E=o(x,2);U(()=>{oe(h,(m(t()),n(()=>`flex-grow: ${t().payByDate}`))),k(x,"data-start",(m(t()),n(()=>t().payByDate))),oe(x,(m(t()),n(()=>`flex-grow: ${t().billingDate-t().payByDate+1}`))),k(E,"data-start",(m(t()),n(()=>t().billingDate))),oe(E,(m(t()),n(()=>`flex-grow: ${31-t().billingDate+1}`)))}),c(g,f)},W=g=>{var f=Le(),h=de(f);k(h,"data-start",0);var x=o(h,2),E=o(x,2);U(()=>{oe(h,(m(t()),n(()=>`flex-grow: ${t().billingDate}`))),k(x,"data-start",(m(t()),n(()=>t().billingDate))),oe(x,(m(t()),n(()=>`flex-grow: ${t().payByDate}`))),k(E,"data-start",(m(t()),n(()=>t().payByDate))),oe(E,(m(t()),n(()=>`flex-grow: ${31-t().billingDate+1}`)))}),c(g,f)};N(A,g=>{m(t()),n(()=>t().billingDate>t().payByDate)?g(S):g(W,!1)})}l(_);var H=o(_,2);{var B=g=>{var f=Oe();k(f,"data-start",0);var h=i(f,!0);l(f),U(()=>{k(f,"data-length",(m(t()),n(()=>t().payByDate))),$(h,(m(t()),n(()=>t().name)))}),c(g,f)};N(H,g=>{d()&&g(B)})}l(b),c(q,b),_e()}var Ge=u('<div class="idea-card svelte-utja49"><!> <p class="svelte-utja49"> </p></div>');function Ve(q,v){let t=D(v,"idea",8);var d=Ge(),b=i(d);Be(b,{get data(){return Ne},scale:1,style:"border-radius: 4rem; color: #ffa029; padding: 0 1rem 0 .5rem; cursor: pointer; align-self: center"});var _=o(b,2),A=i(_,!0);l(_),l(d),U(()=>$(A,t())),c(q,d)}var je=u("<h1> </h1>"),qe=u("<h1>Recent Transactions</h1>"),He=u('<a class="svelte-1gzei9r">view all</a>'),Je=u("<p>We don't see any transactions this month so far...</p>"),Ke=u(`<h2 class="recent-spends__title svelte-1gzei9r">Your recent spends</h2> <div class="recent-spends__content svelte-1gzei9r"><div class="recent-spends__spend-tile svelte-1gzei9r"><p>Today's spend</p> <p class="recent-spends__spend-amount svelte-1gzei9r"> </p></div> <div class="recent-spends__spend-tile svelte-1gzei9r"><p>This month's spend</p> <p class="recent-spends__spend-amount svelte-1gzei9r"> </p></div></div>`,1),We=u('<div></div> <!> <p class="disclaimer svelte-1gzei9r">It might take upto an hour for latest transactions to show up here...</p>',1),Xe=u('<div class="transaction-card svelte-1gzei9r"><div class="recent-transaction svelte-1gzei9r"><div class="non-amount-details svelte-1gzei9r"><span class="svelte-1gzei9r">Total spend</span></div> <span class="svelte-1gzei9r"> </span></div></div> <hr/>',1),Ze=u('<span class="svelte-1gzei9r"> </span>'),et=u('<span class="svelte-1gzei9r">Unknown</span>'),tt=u('<span class="svelte-1gzei9r"> </span>'),at=u('<span class="svelte-1gzei9r">-</span>'),st=u('<a class="transaction-card svelte-1gzei9r"><div class="recent-transaction svelte-1gzei9r"><div class="non-amount-details svelte-1gzei9r"><!> <span class="paid-on svelte-1gzei9r"> </span></div> <!></div></a>'),rt=u(`<p>Not seeing a transaction here? You can <a class="transaction-add-cta svelte-1gzei9r">add one</a> manually
      too.</p>`),nt=u('<div class="container svelte-1gzei9r"><div><!> <!></div> <!> <!> <!> <!> <!></div>');function lt(q,v){me(v,!1);const t=F(),d=F(),b=F(),_=F();let A=D(v,"transactions",24,()=>[]),S=D(v,"showViewAllCTA",8,!0),W=D(v,"showAllTransactions",8,!1),H=D(v,"showRecentSpends",8,!1),B=D(v,"showGraph",8,!1),g=D(v,"showTotalSpend",8,!0),f=D(v,"title",8,void 0),h=D(v,"totalSpend",12,0),x=D(v,"initialShowCount",8,5);we(async()=>{if(window.ApexCharts){z(_,window.ApexCharts);return}await E()});const E=async()=>{const a=await Ee(()=>import("../chunks/CHyJ2wzr.js").then(s=>s.a),__vite__mapDeps([0,1,2,3]),import.meta.url);window.ApexCharts=a.default,z(_,a.default)},ne=(a,s)=>{if(!e(_))return;if(s.length>0){let r=new Date(e(t)[0].paidAt),j=new Date(r.getUTCFullYear(),r.getUTCMonth()+1,0).getDate();for(let P=1;P<=j;P++){let ee=new Date(r.getUTCFullYear(),r.getUTCMonth(),P);e(t).find(te=>new Date(te.paidAt).getDate()===ee.getDate()&&new Date(te.paidAt).getMonth()===ee.getMonth()&&new Date(te.paidAt).getFullYear()===ee.getFullYear())||e(t).push({paidAt:ee.toISOString(),amount:0})}}let R=e(t).map(r=>({x:new Date(r.paidAt).getDate(),y:r.amount,note:`${r.amount}`})).reduce((r,T,j)=>{if(j==0)return[T];if(T.x==r[r.length-1].x){let P=r[r.length-1];return[...r.slice(0,-1),{y:P.y+T.y,x:P.x,note:`${P.note} - + ${T.y}`}]}return[...r,{x:T.x,y:T.y,note:T.note}]},[]);R.sort((r,T)=>r.x-T.x),h(R.reduce((r,T)=>r+T.y,0));let V={colors:["var(--primary-color)"],legend:{show:!1},stroke:{curve:"smooth",width:2},chart:{type:"area"},series:[{name:"payments",data:R.map(r=>r.y)}],xaxis:{categories:R.map(r=>r.x),labels:{show:!0}},yaxis:{labels:{show:!1}},dataLabels:{enabled:!0,style:{colors:["#5e5e5e"]},formatter:r=>r===0?void 0:`â‚¹ ${Intl.NumberFormat(void 0,{style:"decimal"}).format(r)}`}},Q=new(e(_))(a,V);return Q.render(),{update(r){Q.updateOptions(r)},destroy(){Q.destroy()}}};L(()=>m(A()),()=>{z(t,A().reduce((a,s)=>a.findIndex(R=>R.id===s.id)===-1?[...a,s]:a,[]).filter(a=>a.paidAt))}),L(()=>{},()=>{z(d,new Intl.DateTimeFormat("en-CA").format(new Date))}),L(()=>(e(t),e(d)),()=>{z(b,e(t).filter(a=>new Intl.DateTimeFormat("en-CA").format(new Date(a.paidAt))===e(d)).reduce((a,s)=>a+s.amount,0))}),L(()=>{},()=>{z(_,void 0)}),De(),ge();var J=nt(),K=i(J),le=i(K);{var ae=a=>{var s=je(),C=i(s,!0);l(s),U(()=>$(C,f())),c(a,s)},w=a=>{var s=qe();c(a,s)};N(le,a=>{f()!==void 0?a(ae):a(w,!1)})}var O=o(le,2);{var se=a=>{var s=He();k(s,"href","transactions"),c(a,s)};N(O,a=>{S()&&a(se)})}l(K);var G=o(K,2);{var X=a=>{var s=Je();c(a,s)};N(G,a=>{m(A()),n(()=>A().length===0)&&a(X)})}var M=o(G,2);{var re=a=>{var s=We(),C=de(s);Re(C,(Q,r)=>ne?.(Q,r),A);var R=o(C,2);{var V=Q=>{var r=Ke(),T=o(de(r),2),j=i(T),P=o(i(j),2),ee=i(P,!0);l(P),l(j);var te=o(j,2),ue=o(i(te),2),I=i(ue,!0);l(ue),l(te),l(T),U((Y,ce)=>{$(ee,Y),$(I,ce)},[()=>(e(b),n(()=>new Intl.NumberFormat(void 0,{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e(b)))),()=>(m(h()),n(()=>new Intl.NumberFormat(void 0,{style:"currency",currency:"INR",maximumFractionDigits:2}).format(h())))]),c(Q,r)};N(R,Q=>{H()&&Q(V)})}ye(2),c(a,s)};N(M,a=>{m(B()),m(A()),e(_),n(()=>B()&&A().length>0&&e(_))&&a(re)})}var ie=o(M,2);{var p=a=>{var s=Xe(),C=de(s),R=i(C),V=o(i(R),2),Q=i(V,!0);l(V),l(R),l(C),ye(2),U(r=>$(Q,r),[()=>(m(h()),n(()=>new Intl.NumberFormat(void 0,{style:"currency",currency:"INR"}).format(h())))]),c(a,s)};N(ie,a=>{g()&&a(p)})}var y=o(ie,2);be(y,1,()=>(m(W()),e(t),m(x()),n(()=>W()?e(t):e(t).slice(0,x()))),a=>a.id,(a,s)=>{var C=st(),R=i(C),V=i(R),Q=i(V);{var r=I=>{var Y=Ze(),ce=i(Y,!0);l(Y),U(()=>$(ce,(e(s),n(()=>e(s).merchant)))),c(I,Y)},T=I=>{var Y=et();c(I,Y)};N(Q,I=>{e(s),n(()=>e(s).merchant!==null)?I(r):I(T,!1)})}var j=o(Q,2),P=i(j,!0);l(j),l(V);var ee=o(V,2);{var te=I=>{var Y=tt(),ce=i(Y,!0);l(Y),U(ze=>$(ce,ze),[()=>(e(s),n(()=>new Intl.NumberFormat(void 0,{style:"currency",currency:"INR"}).format(e(s).amount)))]),c(I,Y)},ue=I=>{var Y=at();c(I,Y)};N(ee,I=>{e(s),n(()=>e(s).amount!==null)?I(te):I(ue,!1)})}l(R),l(C),U(I=>{k(C,"href",(e(s),n(()=>`/transaction?id=${e(s).id}`))),$(P,I)},[()=>(m(Ie),e(s),n(()=>Ie(new Date(e(s).paidAt))))]),c(a,C)});var Z=o(y,2);{var he=a=>{var s=rt(),C=o(i(s));k(C,"href","transaction/add"),ye(),l(s),c(a,s)};N(Z,a=>{S()&&a(he)})}l(J),U(()=>Fe(K,1,`title ${f()===""?"title--hidden":""}`,"svelte-1gzei9r")),c(q,J),_e()}var it=u('<h1 class="title_bill svelte-9nf6o4">Your bills</h1>'),ot=u('<button class="bill svelte-9nf6o4"><!></button>'),vt=u(`<div class="timeline svelte-9nf6o4"><div class="timeline-data svelte-9nf6o4"><!> <!> <p class="stay-updated svelte-9nf6o4">Stay updated with the bills you need to pay this month...</p> <!> <div class="items bill-payments svelte-9nf6o4"></div> <h1 class="title_bill svelte-9nf6o4">Billing Cycles</h1> <p>Each month, your bills are generated at the start of the bar, and are to
      be paid when the bar ends. Bars wrapping around mean they can be paid the
      next month</p> <div class="legend legend-top svelte-9nf6o4"><span class="svelte-9nf6o4">1</span> <span class="svelte-9nf6o4"> </span></div> <div class="items svelte-9nf6o4"></div> <div class="legend legend-bottom svelte-9nf6o4"><span class="svelte-9nf6o4">1</span> <span class="svelte-9nf6o4"> </span></div></div> <button class="cta svelte-9nf6o4">Add bill</button></div>`);function dt(q,v){me(v,!1);const t=F();let d=D(v,"title",12,""),b=D(v,"items",24,()=>[]),_=D(v,"stats",24,()=>({})),A=D(v,"transactions",24,()=>[]),S=D(v,"billingStatements",8),W=D(v,"onRecordingPayment",8),H=D(v,"onCurrentBillStatementDoesNotExist",8),B=F(31),g=F([]),f=F("");we(()=>{let p=new Date(new Date().getUTCFullYear(),new Date().getUTCMonth()+1,0);z(B,p.getDate()),z(f,Intl.DateTimeFormat(void 0,{month:"long"}).format(p)),d()===""&&d(`Timeline view for ${e(f)}`),z(g,_().stats.filter(y=>y.type==="FULL_PAYMENT_DATES"))}),L(()=>m(b()),()=>{z(t,b().toSorted((p,y)=>p.isEnabled?y.isEnabled?p.billingDate==null&&p.payByDate==null&&y.billingDate==null&&y.payByDate==null?-1:p.name.localeCompare(y.name):Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY))}),De(),ge();var h=vt(),x=i(h),E=i(x);lt(E,{get transactions(){return A()},showGraph:!0,get title(){return d()},showRecentSpends:!0,showTotalSpend:!1});var ne=o(E,2);{var J=p=>{var y=it();c(p,y)};N(ne,p=>{e(t),n(()=>e(t).length>0)&&p(J)})}var K=o(ne,4);{var le=p=>{{let y=ve(()=>(e(f),e(g),n(()=>`Pay all bills together by paying between ${e(f)} ${e(g)[0].dateRanges[0].start} and ${e(f)} ${e(g)[0].dateRanges[0].end}!`)));Ve(p,{get idea(){return e(y)}})}};N(K,p=>{e(g),n(()=>e(g).length>0)&&p(le)})}var ae=o(K,2);be(ae,5,()=>(e(t),n(()=>e(t).filter(p=>p.payByDate!==null))),xe,(p,y)=>{{let Z=ve(()=>(m(S()),e(y),n(()=>S()?.[`billStatements__bill_${e(y).id}`])));Qe(p,{get bill(){return e(y)},get billingStatements(){return e(Z)},get onRecordingPayment(){return W()},get onCurrentBillStatementDoesNotExist(){return H()}})}}),l(ae);var w=o(ae,6),O=o(i(w),2),se=i(O,!0);l(O),l(w);var G=o(w,2);be(G,5,()=>e(t),xe,(p,y)=>{var Z=ot(),he=i(Z);$e(he,{get item(){return e(y)}}),l(Z),Se("click",Z,()=>Te(`bills?id=${e(y).id}`)),c(p,Z)}),l(G);var X=o(G,2),M=o(i(X),2),re=i(M,!0);l(M),l(X),l(x);var ie=o(x,2);l(h),U(()=>{$(se,e(B)),$(re,e(B))}),Se("click",ie,()=>{Te("bills/add")}),c(q,h),_e()}var ct=u('<p class="svelte-n0pvsf">Loading...</p>'),pt=u('<p class="svelte-n0pvsf">ðŸ™† Uh oh! Unable to fetch your bills!</p>'),ut=u('<section class="timeline-page svelte-n0pvsf"><!></section>');function It(q,v){me(v,!1);const t=()=>pe(Me,"$liteServices",S),d=()=>pe(e(f),"$billsQuery",S),b=()=>pe(e(x),"$billStatsQuery",S),_=()=>pe(e(E),"$transactionsQuery",S),A=()=>pe(e(h),"$billStatementsQuery",S),[S,W]=Ce(),H=F(),B=F(),g=F(),f=F(),h=F(),x=F(),E=F();we(()=>{Ye.update(w=>({...w,title:Pe.PAYOBILLS_LITE,isOpen:!0}))}),new Date().getUTCMonth()+1,new Date().getUTCFullYear();const ne=({bill:w,amount:O,isFullyPaid:se,cycleFromDate:G,cycleToDate:X})=>e(B).addBillStatement({notes:"",amount:O,isFullyPaid:se,bill:{id:w.id},startDate:G,endDate:X,edges:{paymentIds:[]}});L(()=>t(),()=>{z(H,t()?.billsService)}),L(()=>t(),()=>{z(B,t()?.billStatementsService)}),L(()=>t(),()=>{z(g,t()?.transactionsService)}),L(()=>e(H),()=>{fe(z(f,e(H)?.queryBills()),"$billsQuery",S)}),L(()=>(d(),e(B)),()=>{fe(z(h,!d()?.fetching&&!d()?.error?e(B)?.queryBillStatementsByBillIds(d().data?.map(w=>w.id)??[]):null),"$billStatementsQuery",S)}),L(()=>(e(B),d()),()=>{fe(z(x,e(B)?.queryBillStatementsByBillIds(d()?.data?.map(w=>w.id)??[])),"$billStatsQuery",S)}),L(()=>e(g),()=>{fe(z(E,e(g)?.queryTransactionsForCurrentMonth()),"$transactionsQuery",S)}),De(),ge();var J=ut(),K=i(J);{var le=w=>{var O=ct();c(w,O)},ae=w=>{var O=Ae(),se=de(O);{var G=M=>{var re=pt();c(M,re)},X=M=>{{let re=ve(()=>(d(),n(()=>d()?.data||[]))),ie=ve(()=>(b(),n(()=>({stats:b()?.data||[]})))),p=ve(()=>(_(),n(()=>_()?.data||[]))),y=ve(()=>(A(),n(()=>A()?.data)));dt(M,{get items(){return e(re)},get stats(){return e(ie)},get transactions(){return e(p)},get billingStatements(){return e(y)},onRecordingPayment:ne})}};N(se,M=>{d(),b(),_(),n(()=>d()?.error||b()?.error||_()?.error)?M(G):M(X,!1)},!0)}c(w,O)};N(K,w=>{d(),b(),_(),n(()=>d()?.fetching||b()?.fetching||_()?.fetching)?w(le):w(ae,!1)})}l(J),c(q,J),_e(),W()}export{It as component};
